### Variables d'environnement
@baseUrl = http://localhost:3000
@authToken = {{login.response.body.access_token}}

### Créer une organisation
POST {{baseUrl}}/organisations
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
    "nom": "BytCode Academy",
    "description": "Centre de formation en cybersécurité",
    "adresse": "123 Rue de la Tech",
    "telephone": "+224 623456789",
    "email": "contact@bytcode.com"
}

### 1. Authentification en tant que superadmin
# @name login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "camara13fs@gmail.com",
  "password": "admin123"
}

### 2. Créer une nouvelle organisation
POST {{baseUrl}}/organisations
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "nom": "BytCode Solutions",
  "type": "entreprise_privee",
  "date_creation": "2024-05-22",
  "code_pays": "GN"
}

### 3. Créer une autre organisation
POST {{baseUrl}}/organisations
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "nom": "CS Roi Hassant 2",
  "type": "etablissement_scolaire",
  "date_creation": "2022-06-15",
  "code_pays": "GN"
}

### 4. Récupérer toutes les organisations
GET {{baseUrl}}/organisations
Authorization: Bearer {{authToken}}

### 5. Récupérer une organisation spécifique (remplacer {id} par l'ID réel)
GET {{baseUrl}}/organisations/1
Authorization: Bearer {{authToken}}

### 6. Obtenir les statistiques d'une organisation
GET {{baseUrl}}/organisations/1/stats
Authorization: Bearer {{authToken}}

### 7. Mettre à jour une organisation
PATCH {{baseUrl}}/organisations/1
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "date_creation": "2024-03-13"
}

### 9. Récupérer les utilisateurs d'une organisation
GET {{baseUrl}}/organisations/1/users
Authorization: Bearer {{authToken}}

### 10. Retirer un utilisateur d'une organisation
DELETE {{baseUrl}}/organisations/1/users/2
Authorization: Bearer {{authToken}}

### 11. Supprimer une organisation (seulement si elle n'a pas d'utilisateurs)
DELETE {{baseUrl}}/organisations/1
Authorization: Bearer {{authToken}}

### 12. Test d'erreur - Créer une organisation avec des données invalides
POST {{baseUrl}}/organisations
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "nom": "",
  "type": "TYPE_INVALIDE",
  "code_pays": "FR",
  "date_creation": "2024-05-22"
}

### 13. Test d'erreur - Accès sans authentification
GET {{baseUrl}}/organisations

### 14. Test d'erreur - Accès avec un rôle insuffisant (utilisateur normal)
# D'abord, connectez-vous en tant qu'utilisateur normal
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "user@gmail.com",
  "password": "user123"
}

### 15
# Puis essayez d'accéder aux organisations
GET {{baseUrl}}/organisations
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InVzZXJAZ21haWwuY29tIiwic3ViIjoyLCJyb2xlIjoidXNlciIsImlhdCI6MTc1NTA0OTA3MCwiZXhwIjoxNzU1MDUyNjcwfQ.tKB2I3bTFUckK-3Ep06JTdxQDLD6ZBywsl3C5f1rOUQ

### 9. Récupérer les utilisateurs d'une organisation
GET {{baseUrl}}/organisations/1/users
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InVzZXJAZ21haWwuY29tIiwic3ViIjoyLCJyb2xlIjoidXNlciIsImlhdCI6MTc1NTA0OTA3MCwiZXhwIjoxNzU1MDUyNjcwfQ.tKB2I3bTFUckK-3Ep06JTdxQDLD6ZBywsl3C5f1rOUQ



# test après ajout des profiles
@access_token = your_access
@refresh_token = your_refresh
### CREATE ORGANISATION (superadmin)
POST http://localhost:3000/organisations
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "nom": "Nouvelle Organisation",
  "type": "Entreprise",
  "code_pays": "FR"
}

### GET ALL ORGANISATIONS
GET http://localhost:3000/organisations
Authorization: Bearer {{access_token}}

### GET ORGANISATION BY ID
GET http://localhost:3000/organisations/1
Authorization: Bearer {{access_token}}

### GET ORGANISATION STATS
GET http://localhost:3000/organisations/1/stats
Authorization: Bearer {{access_token}}

### GET ORGANISATION USERS
GET http://localhost:3000/organisations/1/users
Authorization: Bearer {{access_token}}

### UPDATE ORGANISATION
PATCH http://localhost:3000/organisations/1
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "nom": "Organisation Modifiée"
}

### DELETE ORGANISATION
DELETE http://localhost:3000/organisations/2
Authorization: Bearer {{access_token}}

### REMOVE USER FROM ORGANISATION
DELETE http://localhost:3000/organisations/1/users/3
Authorization: Bearer {{access_token}}